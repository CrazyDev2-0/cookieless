<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTTP Request Example</title>
</head>
<body>

<p id="eTagParagraph">E-Tag: Loading...</p>
<span id="generatedToken"></span>
<script src="/cookieless.js"></script>
<script>
    // Function to make the HTTP request
    async function makeRequest() {
        try {
            let token = await generateToken();
            // TODO: remove below line
            document.getElementById("generatedToken").innerHTML = token;
            const response = await fetch('http://localhost:8080/?fingerprint='+token);

            // Check if the request was successful (status code 200)
            if (response.ok) {
                // Get the E-Tag header from the response
                const eTag = response.headers.get('etag');
                // Set the E-Tag value in the paragraph text TODO: remove
                const eTagParagraph = document.getElementById('eTagParagraph');
                eTagParagraph.textContent = `E-Tag: ${eTag}`;
                console.log('E-Tag:', eTag);
            } else {
                console.error('Request failed with status:', response.status);
            }
        } catch (error) {
            console.error('Error during the request:', error);
        }
    }
    makeRequest();
</script>

</body>
</html>
